<%- include('../partials/header', { title: 'Mis Productos' }) %>
<div class="container mt-4">
Â  <div class="d-flex justify-content-between align-items-center mb-3">
Â Â Â  <h3>Mis Publicaciones</h3>
Â Â Â  <div>
Â Â Â Â Â  <a href="/usuario/perfil" class="btn btn-outline-secondary">ðŸ‘¤ Editar Mi Perfil</a>
Â Â Â Â Â  <a href="/usuario/crear-producto" class="btn btn-primary ms-2">âž• Vender un Producto</a>
Â Â Â  </div>
Â  </div>
Â  
Â  <div class="card shadow-sm">
Â Â Â  <div class="card-body">
Â Â Â Â Â  <div class="table-responsive">
Â Â Â Â Â Â Â  <table class="table table-hover align-middle">
Â Â Â Â Â Â Â Â Â  <thead>
Â Â Â Â Â Â Â Â Â Â Â  <tr class="table-light">
Â Â Â Â Â Â Â Â Â Â Â Â Â  <th scope="col">Imagen</th>
Â Â Â Â Â Â Â Â Â Â Â Â Â  <th scope="col">Nombre</th>
Â Â Â Â Â Â Â Â Â Â Â Â Â  <th scope="col">Precio</th>
Â Â Â Â Â Â Â Â Â Â Â Â Â  <th scope="col">Stock</th>
Â Â Â Â Â Â Â Â Â Â Â Â Â  <th scope="col" class="text-end">Acciones</th>
Â Â Â Â Â Â Â Â Â Â Â  </tr>
Â Â Â Â Â Â Â Â Â  </thead>
Â Â Â Â Â Â Â Â Â  <tbody>
Â Â Â Â Â Â Â Â Â Â Â  <% if (productos.length > 0) { %>
Â Â Â Â Â Â Â Â Â Â Â Â Â  <% productos.forEach(producto => { %>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <tr>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <td>
                    <% 
                        const thumbImageUrl = (producto.imagenes && producto.imagenes.length > 0) 
                            ? producto.imagenes[0].url 
                            : '/uploads/default.png'; // Fallback
                    %>
                    <img src="<%= thumbImageUrl %>" alt="<%= producto.nombre %>" style="width: 60px; height: 60px; object-fit: cover; border-radius: 5px;">
                  </td>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <td><%= producto.nombre %></td>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <td>Gs. <%= producto.precio.toLocaleString('es-ES') %></td>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <td><%= producto.stock %></td>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <td class="text-end">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <a href="/usuario/editar-producto/<%= producto._id %>" class="btn btn-sm btn-outline-secondary me-2">Editar</a>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <form action="/usuario/eliminar-producto/<%= producto._id %>?_method=DELETE" method="POST" class="d-inline" onsubmit="return confirm('Â¿EstÃ¡s seguro de que quieres eliminar esta publicaciÃ³n?');">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <button type="submit" class="btn btn-sm btn-outline-danger">Eliminar</button>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </form>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </td>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </tr>
Â Â Â Â Â Â Â Â Â Â Â Â Â  <% }) %>
Â Â Â Â Â Â Â Â Â Â Â  <% } else { %>
Â Â Â Â Â Â Â Â Â Â Â Â Â  <tr>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <td colspan="5" class="text-center p-4">AÃºn no has publicado ningÃºn producto.</td>
Â Â Â Â Â Â Â Â Â Â Â Â Â  </tr>
Â Â Â Â Â Â Â Â Â Â Â  <% } %>
Â Â Â Â Â Â Â Â Â  </tbody>
Â Â Â Â Â Â Â  </table>
Â Â Â Â Â  </div>
Â Â Â  </div>
Â  </div>
</div>
<%- include('../partials/footer') %>
