<%- include('../partials/header', { title: 'Gestionar Productos' }) %>
<div class="container mt-4">
  <h3>Gestionar Todos los Productos</h3>
  <div class="card shadow-sm mt-3">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead>
            <tr class="table-light">
              <th>Imagen</th>
              <th>Nombre</th>
              <th>Precio</th>
              <th>Stock</th>
              <th>Vendedor</th>
              <th class="text-end">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <% productos.forEach(producto => { %>
              <tr>
                <td><img src="/uploads/<%= producto.imagen %>" alt="<%= producto.nombre %>" style="width: 60px; height: 60px; object-fit: cover; border-radius: 5px;"></td>
                <td><a href="/producto/<%= producto._id %>"><%= producto.nombre %></a></td>
                <td>Gs. <%= producto.precio.toLocaleString('es-ES') %></td>
                <td><%= producto.stock %></td>
                <td><%= producto.vendedor ? producto.vendedor.nombre : 'Usuario eliminado' %></td>
                <td class="text-end">
                  <!-- AÑADIMOS EL BOTÓN DE EDITAR -->
                  <a href="/admin/editar-producto/<%= producto._id %>" class="btn btn-sm btn-outline-secondary me-2">Editar</a>
                  
                  <form action="/admin/eliminar-producto/<%= producto._id %>?_method=DELETE" method="POST" class="d-inline" onsubmit="return confirm('¿Estás seguro de que quieres eliminar este producto?');">
                    <button type="submit" class="btn btn-sm btn-outline-danger">Eliminar</button>
                  </form>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<%- include('../partials/footer') %>
