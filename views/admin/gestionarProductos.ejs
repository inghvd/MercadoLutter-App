<%- include('../partials/header', { title: 'Gestionar Productos' }) %>

<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Gestionar Productos</h3>
    <a href="/admin/crear-producto" class="btn btn-primary">➕ Cargar Nuevo Producto</a>
  </div>
  
  <div class="card shadow-sm">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead>
            <tr>
              <th scope="col">Imagen</th>
              <th scope="col">Nombre</th>
              <th scope="col">Precio</th>
              <th scope="col">Stock</th>
              <th scope="col" class="text-end">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <% if (productos.length > 0) { %>
              <% productos.forEach(producto => { %>
                <tr>
                  <td>
                    <img src="/uploads/<%= producto.imagen %>" alt="<%= producto.nombre %>" style="width: 60px; height: 60px; object-fit: cover; border-radius: 5px;">
                  </td>
                  <td><%= producto.nombre %></td>
                  <td>Gs. <%= producto.precio.toLocaleString('es-ES') %></td>
                  <td><%= producto.stock %></td>
                  <td class="text-end">
                    <a href="/admin/editar-producto/<%= producto._id %>" class="btn btn-sm btn-outline-secondary me-2">Editar</a>
                    <!-- Formulario para el botón de eliminar -->
                    <form action="/admin/eliminar-producto/<%= producto._id %>" method="POST" class="d-inline" onsubmit="return confirm('¿Estás seguro de que quieres eliminar este producto?');">
                      <button type="submit" class="btn btn-sm btn-outline-danger">Eliminar</button>
                    </form>
                  </td>
                </tr>
              <% }) %>
            <% } else { %>
              <tr>
                <td colspan="5" class="text-center">No hay productos cargados todavía.</td>
              </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>
